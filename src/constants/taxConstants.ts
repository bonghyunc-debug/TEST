// ============================================================================
// Smart Capital Gain Wizard - Tax Constants
// 양도소득세 세율표 및 상수 정의
// ============================================================================

// ---------------------------------------------------------------------------
// 누진세율표
// ---------------------------------------------------------------------------

export interface TaxBracket {
  upTo: number;
  rate: number;
  deduction: number;
}

/** 2022년 세율표 */
export const TAX_BRACKETS_2022: TaxBracket[] = [
  { upTo: 12_000_000, rate: 6, deduction: 0 },
  { upTo: 46_000_000, rate: 15, deduction: 1_080_000 },
  { upTo: 88_000_000, rate: 24, deduction: 5_220_000 },
  { upTo: 150_000_000, rate: 35, deduction: 14_900_000 },
  { upTo: 300_000_000, rate: 38, deduction: 19_400_000 },
  { upTo: 500_000_000, rate: 40, deduction: 25_400_000 },
  { upTo: 1_000_000_000, rate: 42, deduction: 35_400_000 },
  { upTo: Number.POSITIVE_INFINITY, rate: 45, deduction: 65_400_000 },
];

/** 2023년 이후 세율표 */
export const TAX_BRACKETS_2023: TaxBracket[] = [
  { upTo: 14_000_000, rate: 6, deduction: 0 },
  { upTo: 50_000_000, rate: 15, deduction: 1_260_000 },
  { upTo: 88_000_000, rate: 24, deduction: 5_760_000 },
  { upTo: 150_000_000, rate: 35, deduction: 15_440_000 },
  { upTo: 300_000_000, rate: 38, deduction: 19_940_000 },
  { upTo: 500_000_000, rate: 40, deduction: 25_940_000 },
  { upTo: 1_000_000_000, rate: 42, deduction: 35_940_000 },
  { upTo: Number.POSITIVE_INFINITY, rate: 45, deduction: 65_940_000 },
];

// ---------------------------------------------------------------------------
// 장기보유특별공제율 테이블
// ---------------------------------------------------------------------------

export interface LTTDEntry {
  minYears: number;
  maxYears: number;
  rate: number;
}

/** 일반 장기보유특별공제 (표1) */
export const LTTD_GENERAL_TABLE: LTTDEntry[] = [
  { minYears: 3, maxYears: 3, rate: 0.06 },
  { minYears: 4, maxYears: 4, rate: 0.08 },
  { minYears: 5, maxYears: 5, rate: 0.10 },
  { minYears: 6, maxYears: 6, rate: 0.12 },
  { minYears: 7, maxYears: 7, rate: 0.14 },
  { minYears: 8, maxYears: 8, rate: 0.16 },
  { minYears: 9, maxYears: 9, rate: 0.18 },
  { minYears: 10, maxYears: 10, rate: 0.20 },
  { minYears: 11, maxYears: 11, rate: 0.22 },
  { minYears: 12, maxYears: 12, rate: 0.24 },
  { minYears: 13, maxYears: 13, rate: 0.26 },
  { minYears: 14, maxYears: 14, rate: 0.28 },
  { minYears: 15, maxYears: Number.POSITIVE_INFINITY, rate: 0.30 },
];

/** 1세대1주택 장기보유특별공제 (표2) */
export const LTTD_ONE_HOUSE_TABLE: LTTDEntry[] = [
  { minYears: 0, maxYears: 1, rate: 0 },
  { minYears: 2, maxYears: 2, rate: 0.08 },
  { minYears: 3, maxYears: 3, rate: 0.12 },
  { minYears: 4, maxYears: 4, rate: 0.16 },
  { minYears: 5, maxYears: 5, rate: 0.20 },
  { minYears: 6, maxYears: 6, rate: 0.24 },
  { minYears: 7, maxYears: 7, rate: 0.28 },
  { minYears: 8, maxYears: 8, rate: 0.32 },
  { minYears: 9, maxYears: 9, rate: 0.36 },
  { minYears: 10, maxYears: Number.POSITIVE_INFINITY, rate: 0.40 },
];

// ---------------------------------------------------------------------------
// 기타 상수
// ---------------------------------------------------------------------------

export const TAX_CONSTANTS = {
  /** 고가주택 기준금액 (2021.12.08 이후) */
  HIGH_PRICE_LIMIT: 1_200_000_000,
  
  /** 8년 자경농지 감면 한도 */
  FARM_YEARLY_LIMIT: 100_000_000,
  
  /** 양도소득 기본공제 */
  BASIC_DEDUCTION: 2_500_000,
  
  /** 납부지연 가산세율 (1일) */
  LATE_INTEREST_RATE: 0.00022,
  
  /** 공익사업 감면율 변경일 */
  PUBLIC_CASH_RATE_CHANGE_DATE: '2025-01-01',
  
  /** 1985년 의제취득일 기준 */
  PRE_1985_DATE: '1985-01-01',
  
  /** 토지등급 환산 기준일 */
  LAND_GRADE_DATE: '1990-08-30',
  
  /** 농특세율 (감면세액 대비) */
  NONGTEUKSE_RATE: 0.2,
  
  /** 지방소득세율 */
  LOCAL_TAX_RATE: 0.1,
};

// ---------------------------------------------------------------------------
// 가산세율
// ---------------------------------------------------------------------------

export const PENALTY_RATES = {
  /** 무신고 가산세율 */
  UNFILED: 0.2,
  /** 무신고 부정 가산세율 */
  UNFILED_FRAUD: 0.4,
  /** 과소신고 가산세율 */
  UNDERFILED: 0.1,
  /** 과소신고 부정 가산세율 */
  UNDERFILED_FRAUD: 0.4,
  /** 납부지연 가산세율 (1일) */
  LATE_PAYMENT_DAILY: 0.00022,
};

// ---------------------------------------------------------------------------
// 토지등급가액표 (1~365등급)
// ---------------------------------------------------------------------------

export const LAND_GRADE_DB: number[] = [
  0, // Index 0 (Not used)
  1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
  11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
  21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
  31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
  42, 44, 46, 48, 50, 52, 54, 56, 58, 60,
  63, 66, 69, 72, 75, 78, 81, 85, 89, 93,
  97, 101, 106, 111, 116, 121, 127, 133, 139, 145,
  152, 159, 166, 174, 182, 191, 200, 210, 220, 231,
  242, 254, 266, 279, 292, 306, 321, 337, 353, 370,
  388, 407, 427, 448, 470, 493, 517, 542, 569, 597,
  626, 657, 689, 723, 759, 796, 835, 876, 919, 964,
  1010, 1060, 1110, 1170, 1220, 1280, 1350, 1420, 1490, 1560,
  1640, 1720, 1810, 1900, 1990, 2090, 2190, 2300, 2420, 2540,
  2670, 2800, 2940, 3090, 3240, 3400, 3570, 3750, 3940, 4130,
  4340, 4560, 4790, 5020, 5280, 5540, 5820, 6110, 6410, 6730,
  7070, 7420, 7790, 8180, 8590, 9020, 9470, 9940, 10400, 10900,
  11500, 12000, 12600, 13300, 13900, 14600, 15400, 16100, 17000, 17800,
  18700, 19600, 20600, 21700, 22700, 23900, 25100, 26300, 27600, 29000,
  30500, 32000, 33600, 35300, 37100, 38900, 40900, 42900, 45100, 47300,
  49700, 52200, 54800, 57500, 60400, 63400, 66600, 69900, 73400, 77100,
  81000, 85000, 89300, 93700, 98400, 103000, 108000, 113000, 119000, 125000,
  131000, 138000, 145000, 152000, 160000, 168000, 176000, 185000, 194000, 204000,
  214000, 225000, 236000, 248000, 261000, 274000, 287000, 302000, 317000, 333000,
  350000, 367000, 385000, 405000, 425000, 446000, 469000, 492000, 517000, 543000,
  570000, 598000, 628000, 660000, 693000, 727000, 764000, 802000, 842000, 884000,
  928000, 975000, 1023000, 1075000, 1128000, 1185000, 1244000, 1306000, 1372000, 1440000,
  1512000, 1588000, 1667000, 1751000, 1838000, 1930000, 2027000, 2128000, 2235000, 2346000,
  2464000, 2587000, 2716000, 2852000, 2995000, 3145000, 3302000, 3467000, 3640000, 3822000,
  4014000, 4214000, 4425000, 4646000, 4879000, 5123000, 5379000, 5648000, 5930000, 6227000,
  6538000, 6865000, 7208000, 7569000, 7947000, 8345000, 8762000, 9200000, 9660000, 10143000,
  10650000, 11183000, 11742000, 12329000, 12945000, 13593000, 14272000, 14986000, 15735000, 16522000,
  17348000, 18216000, 19127000, 20083000, 21087000, 22141000, 23249000, 24411000, 25632000, 26913000,
  28259000, 29672000, 31155000, 32713000, 34349000, 36066000, 37870000, 39763000, 41751000, 43839000,
  46031000, 48883000, 50749000, 53287000, 55951000, 58749000, 61686000, 64771000, 68009000, 71410000,
  74980000, 78729000, 82666000, 86799000, 91139000, 95696000, 100481000, 105505000, 110781000, 116320000,
  121860000, 127400000, 132950000, 138000000, 144050000, 149600000, 155150000, 160000000, 166250000, 171800000,
  177350000, 182900000, 188450000, 194000000, 200000000,
];

/** 토지등급 조회 함수 */
export function getLandGradeValue(grade: number): number {
  const g = Math.round(grade);
  if (isNaN(g) || g < 1) return 0;
  if (g >= LAND_GRADE_DB.length) return LAND_GRADE_DB[LAND_GRADE_DB.length - 1];
  return LAND_GRADE_DB[g];
}

// ---------------------------------------------------------------------------
// 공휴일 (설/추석 양력 일자)
// ---------------------------------------------------------------------------

export const FIXED_PUBLIC_HOLIDAYS = [
  '01-01', '03-01', '05-01', '05-05', '06-06',
  '08-15', '10-03', '10-09', '12-25',
];

export const LUNAR_HOLIDAY_MAP: Record<number, string[]> = {
  2023: ['2023-01-21', '2023-01-22', '2023-01-23', '2023-09-28', '2023-09-29', '2023-09-30'],
  2024: ['2024-02-09', '2024-02-10', '2024-02-11', '2024-02-12', '2024-09-16', '2024-09-17', '2024-09-18'],
  2025: ['2025-01-28', '2025-01-29', '2025-01-30', '2025-10-06', '2025-10-07', '2025-10-08'],
  2026: ['2026-02-16', '2026-02-17', '2026-02-18', '2026-09-24', '2026-09-25', '2026-09-26'],
};

// ---------------------------------------------------------------------------
// 자산 유형 레이블
// ---------------------------------------------------------------------------

export const ASSET_TYPE_LABELS: Record<string, string> = {
  general_house: '일반주택',
  high_price_house: '1세대1주택 (고가주택)',
  commercial: '상가/건물',
  land: '토지',
  land_farm: '자경/대토 농지',
  presale_right: '분양권',
  membership_right: '조합원입주권',
  unregistered: '미등기',
};

export const TRANSFER_CAUSE_LABELS: Record<string, string> = {
  sale: '매매',
  expropriation: '수용',
  auction: '경매/공매',
  burden_gift: '부담부증여',
  exchange: '교환',
};

export const ACQUISITION_CAUSE_LABELS: Record<string, string> = {
  purchase: '매매',
  construction: '신축',
  auction: '경매/공매',
  inheritance: '상속',
  gift: '증여',
  gift_carryover: '증여 (이월과세)',
};

export const RELIEF_TYPE_LABELS: Record<string, string> = {
  none: '해당 없음',
  farm_8y: '8년 자경 농지',
  farmland_exchange: '농지 대토',
  public_cash: '공익사업 수용 (현금)',
  public_replacement: '공익사업 수용 (대토)',
  custom: '직접 입력',
};
